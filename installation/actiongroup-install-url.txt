drafts://actionGroup?data=%7B%22createdAt%22:772993961.836388,%22actions%22:%5B%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22Enable%20or%20disable%20%E2%80%9CShopping%20mode%E2%80%9D.%20This%20is%20a%20convenience%20script%20to%20turn%20on%20or%20off%20three%20features%20at%20once:%5Cn%5Cn-%20Focus%20mode%5Cn-%20Link%20mode%5Cn-%20The%20device%20idle%20(sleep)%20timer%5Cn%5CnMy%20primary%20use%20for%20this%20%E2%80%9Cmode%E2%80%9D%20is%20shopping%20at%20the%20grocery%20store.%20I%20make%20a%20task%20%5B%20%5D%20list%20in%20a%20draft.%20Enabling%20focus%20mode%20keeps%20my%20shopping%20list%20active.%20Enabling%20link%20mode%20keeps%20accidental%20taps%20from%20entering%20edit%20mode%20and%20showing%20the%20keyboard.%20Disabling%20the%20system%20idle%20timer%20keeps%20your%20phone%20from%20going%20to%20sleep%20so%20you%20don%E2%80%99t%20have%20to%20wake%20up%20the%20phone%20every%20time%20you%20want%20to%20check%20off%20another%20item.%5Cn%5CnFor%20more%20details%20on%20using%20this%20action,%20read%20the%20%5BWorking%20with%20Lists%5D(https:%5C/%5C/forums.getdrafts.com%5C/t%5C/tip-working-with-task-shopping-lists-in-drafts%5C/2523)%20tip%20article.%22,%22backingIsSeparator%22:false,%22uuid%22:%22E3E10AAD-30CB-4825-AC2E-0554871DA521%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%223FD4217F-4607-4C4A-A8C6-D3E3A63E8ADA%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22let%20p%20%3D%20Prompt.create();%5Cnp.title%20%3D%20%5C%22Kochmodus%5C%22%5Cnp.message%20%3D%20%5C%22Bearbeitung%20und%20automatische%20Bildschirmabschaltung%20deaktivieren%5C%22%5Cn%5Cnp.addButton(%5C%22einschalten%5C%22)%5Cnp.addButton(%5C%22ausschalten%5C%22)%5Cnp.isCancellable%20%3D%20true%5Cn%5Cnif%20(p.show())%20%7B%5Cn%5Ctif%20(p.buttonPressed%20%3D%3D%20%5C%22einschalten%5C%22)%20%7B%5Cn%5Ct%5Ctapp.isIdleDisabled%20%3D%20true%5Cn%5Ct%5Cteditor.focusModeEnabled%20%3D%20true%5Cn%5Ct%5Cteditor.linkModeEnabled%20%3D%20true%5Cn%5Ct%7D%5Cn%5Ctelse%20%7B%20%5C/%5C/%20ausschalten%5Cn%5Ct%5Ctapp.isIdleDisabled%20%3D%20false%5Cn%5Ct%5Cteditor.focusModeEnabled%20%3D%20false%5Cn%5Ct%5Cteditor.linkModeEnabled%20%3D%20false%5Cn%5Ct%7D%5Cn%7D%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22fire%22,%22visibility%22:2016,%22disposition%22:0,%22keyCommand%22:%7B%22shiftKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22optionKey%22:false,%22controlKey%22:false,%22input%22:%22%22,%22discoverabilityTitle%22:%22Kochmodus%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:1,%22notificationType%22:1,%22shouldConfirm%22:false,%22name%22:%22Kochmodus%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%2292398936-B7B2-4397-A9F7-B0B4F466BAF1%22,%22steps%22:%5B%5D,%22assignTags%22:%5B%5D,%22icon%22:%22%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22controlKey%22:false,%22optionKey%22:false,%22input%22:%22%22,%22type%22:%22empty%22,%22commandKey%22:false,%22shiftKey%22:false,%22discoverabilityTitle%22:%22Invalid%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22separator%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22none%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Rezepteverwaltung%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22archiviert%20das%20neue%20Rezept%20mit%20den%20entsprechenden%20Tags.%22,%22backingIsSeparator%22:false,%22uuid%22:%2259D60F17-F41E-48BE-AA61-EFA8B6D04222%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%2255E733A4-B45B-4C69-9245-9A878D7F4B72%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22tags%20%3D%20%5B'rezept',%20'neuesrezept'%5D%5Cn%5Cnlet%20allTags%20%3D%20Tag.query(%5C%22%5C%22);%5Cnlet%20regex%20%3D%20%5C/%5Erezept%5C%5C%5C/%5C/%5Cnlet%20rezeptTags%20%3D%20allTags%5Cn%20%20%20%20.filter(eintrag%20%3D%3E%20regex.test(eintrag))%20%20%5C/%5C/%20Nur%20die%20Eintr%C3%A4ge%20behalten,%20die%20mit%20%5C%22rezept%5C/%5C%22%20beginnen%5Cn%20%20%20%20.map(eintrag%20%3D%3E%20eintrag.replace(regex,%20''));%20%20%5C/%5C/%20%5C%22rezept%5C/%5C%22%20aus%20den%20gefilterten%20Eintr%C3%A4gen%20entfernen%5Cn%5Cnlet%20prompt%20%3D%20Prompt.create();%5Cnprompt.title%20%3D%20'Tags%20zuweisen';%5Cnprompt.message%20%3D%20'W%C3%A4hle%20aus%20der%20Liste.%5C%5CnUm%20neue%20Tags%20einzugeben,%20dr%C3%BCcke%20Cancel%20und%20gib%20manuell%20oben%20in%20der%20Tag-Zeile%20ein.%20F%C3%BChre%20diese%20Action%20dann%20nochmal%20aus.'%5Cnprompt.addSelect('selection',%20'',%20rezeptTags,%20%5B%5D,%20true);%5Cnprompt.addButton(%5C%22OK%5C%22,%201,%20true)%5Cn%5Cnif%20(prompt.show())%20%7B%5Cn%20%20var%20selectedTags%20%3D%20prompt.fieldValues%5B'selection'%5D;%5Cn%20%20let%20praefix%20%3D%20%5C%22rezept%5C/%5C%22;%5Cn%20%20let%20tagList%20%3D%20selectedTags.map(tag%20%3D%3E%20praefix%20+%20tag);%5Cn%20%20tags.push(...tagList);%5Cn%7D%5Cn%5Cnif%20(prompt.buttonPressed%20%3D%3D%201)%20%7B%5Cn%20%20draft.append(tags);%5Cn%20%20tags.forEach(function(tag)%20%7B%5Cn%20%20%20%20draft.addTag(tag);%5Cn%20%20%7D);%5Cn%20%20draft.isArchived%20%3D%20true;%5Cn%20%20draft.update();%5Cn%7D%5Cn%5Cn%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22601-enter%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22shiftKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22type%22:%22action%22,%22discoverabilityTitle%22:%22neues%20Rezept%20einspeisen%22,%22commandKey%22:false,%22optionKey%22:false%7D,%22keyUseIcon%22:true,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22neues%20Rezept%20einspeisen%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%22D40772D0-5BC0-4512-B188-9029384483E8%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%2219234A0D-EC7E-4E22-96B2-616769697127%22,%22data%22:%7B%22name%22:%22Unflag%22%7D,%22type%22:%22includeAction%22,%22isEnabled%22:true%7D,%7B%22platforms%22:3,%22uuid%22:%2250FAB2E4-7D1C-4B8C-8A88-E531E190DFAB%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22draft.removeTag(%5C%22neuesrezept%5C%22);%5Cndraft.update();%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%22rezept%22%5D,%22icon%22:%22321-like%22,%22disposition%22:1,%22visibility%22:2016,%22keyCommand%22:%7B%22commandKey%22:false,%22controlKey%22:false,%22optionKey%22:false,%22type%22:%22action%22,%22shiftKey%22:false,%22input%22:%22%22,%22discoverabilityTitle%22:%22hat%20gut%20geschmeckt!%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22hat%20gut%20geschmeckt!%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%2237F6BDDC-D3E9-40FE-A5A4-BAF2785889C3%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%2287316DB7-DDCF-4C12-8E87-57767D50258D%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22draft.removeTag(%5C%22rezept%5C%22);%5Cndraft.removeTag(%5C%22neuesrezept%5C%22);%5Cndraft.addTag(%5C%22verworfenesrezept%5C%22)%5Cndraft.update();%5Cn%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D,%7B%22platforms%22:3,%22uuid%22:%2219234A0D-EC7E-4E22-96B2-616769697127%22,%22data%22:%7B%22name%22:%22Unflag%22%7D,%22type%22:%22includeAction%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22322-dislike%22,%22disposition%22:1,%22visibility%22:2016,%22keyCommand%22:%7B%22discoverabilityTitle%22:%22das%20koche%20nie%20wieder!%22,%22type%22:%22action%22,%22input%22:%22%22,%22optionKey%22:false,%22shiftKey%22:false,%22commandKey%22:false,%22controlKey%22:false%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22das%20koche%20nie%20wieder!%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%2280F7139E-008F-46A3-950E-1452F3F4B34D%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%225333A3DB-3101-4D4E-84E2-A43B6C1E5255%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22tags%20%3D%20%5B%5D%5Cn%5Cnlet%20allTags%20%3D%20Tag.query(%5C%22%5C%22);%5Cnlet%20regex%20%3D%20%5C/%5Erezept%5C%5C%5C/%5C/%5Cnlet%20rezeptTags%20%3D%20allTags%5Cn%20%20%20%20.filter(eintrag%20%3D%3E%20regex.test(eintrag))%20%20%5C/%5C/%20Nur%20die%20Eintr%C3%A4ge%20behalten,%20die%20mit%20%5C%22rezept%5C/%5C%22%20beginnen%5Cn%20%20%20%20.map(eintrag%20%3D%3E%20eintrag.replace(regex,%20''));%20%20%5C/%5C/%20%5C%22rezept%5C/%5C%22%20aus%20den%20gefilterten%20Eintr%C3%A4gen%20entfernen%5Cn%5Cnlet%20prompt%20%3D%20Prompt.create();%5Cnprompt.title%20%3D%20'Tags%20zuweisen';%5Cnprompt.message%20%3D%20'W%C3%A4hle%20aus%20der%20Liste.%5C%5CnUm%20neue%20Tags%20einzugeben,%20dr%C3%BCcke%20Cancel%20und%20gib%20manuell%20oben%20in%20der%20Tag-Zeile%20ein.%20F%C3%BChre%20diese%20Action%20dann%20nochmal%20aus.'%5Cnprompt.addSelect('selection',%20'',%20rezeptTags,%20%5B%5D,%20true);%5Cnprompt.addButton(%5C%22OK%5C%22,%201,%20true)%5Cn%5Cnif%20(prompt.show())%20%7B%5Cn%20%20var%20selectedTags%20%3D%20prompt.fieldValues%5B'selection'%5D;%5Cn%20%20let%20praefix%20%3D%20%5C%22rezept%5C/%5C%22;%5Cn%20%20let%20tagList%20%3D%20selectedTags.map(tag%20%3D%3E%20praefix%20+%20tag);%5Cn%20%20tags.push(...tagList);%5Cn%7D%5Cn%5Cnif%20(prompt.buttonPressed%20%3D%3D%201)%20%7B%5Cn%20%20draft.append(tags);%5Cn%20%20tags.forEach(function(tag)%20%7B%5Cn%20%20%20%20draft.addTag(tag);%5Cn%20%20%7D);%5Cn%20%20draft.update();%5Cn%7D%5Cn%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22btn_tags%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22controlKey%22:false,%22shiftKey%22:false,%22input%22:%22%22,%22commandKey%22:false,%22optionKey%22:false,%22discoverabilityTitle%22:%22Tags%20zuweisen%22,%22type%22:%22action%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Tags%20zuweisen%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%222843DB31-08E9-4A9D-81A3-34EE0FD92373%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%22213907F5-21A2-4F0E-BAF2-9CDE55F799E9%22,%22data%22:%7B%22script%22:%22let%20kochplan%20%3D%20Draft.queryByTitle(%5C%22Kochplan:%5C%22)%5B0%5D;%5Cneditor.load(kochplan)%5Cn%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D,%7B%22platforms%22:1,%22uuid%22:%22D1854220-B917-40EF-A24A-D86AB895C304%22,%22data%22:%7B%22actionList%22:%22hide%22,%22pinningEnabled%22:%22noChange%22,%22actionBar%22:%22noChange%22,%22draftList%22:%22hide%22,%22loadActionGroup%22:%22%22,%22loadWorkspace%22:%22%22,%22loadActionBarGroup%22:%22%22,%22tagEntry%22:%22noChange%22,%22linksEnabled%22:%22noChange%22%7D,%22type%22:%22configure%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22calendar-favorite%22,%22disposition%22:0,%22visibility%22:2016,%22keyCommand%22:%7B%22controlKey%22:false,%22shiftKey%22:false,%22input%22:%22%22,%22commandKey%22:false,%22optionKey%22:false,%22discoverabilityTitle%22:%22Kochplan%20zeigen%22,%22type%22:%22action%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Kochplan%20zeigen%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%224DC712D0-2809-4687-A051-F33EEAF93D6C%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%22D34DBEE9-91DA-4762-ACC8-B33B4BD17B35%22,%22data%22:%7B%22script%22:%22const%20kochplan%20%3D%20Draft.queryByTitle(%5C%22Kochplan:%5C%22)%5B0%5D%5Cnlet%20thisdraft%20%3D%20draft.processTemplate(%5C%22%5B%5Bdisplay_title%5D%5D%5C%22);%5Cnnewentry%20%3D%20%60-%20%5B%5B%60%20+%20thisdraft%20+%20%60%5D%5D%60%5Cn%5Cn%5C/%5C/%20add%20link%20to%20current%20draft%20to%20kochplan%5Cnkochplan.append(newentry)%5Cnkochplan.update()%22,%22allowAsync%22:%22false%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22430-checkmark3%22,%22disposition%22:0,%22visibility%22:2016,%22keyCommand%22:%7B%22optionKey%22:false,%22controlKey%22:false,%22commandKey%22:false,%22shiftKey%22:false,%22type%22:%22action%22,%22input%22:%22%22,%22discoverabilityTitle%22:%22auf%20den%20Kochplan%20setzen!%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22auf%20den%20Kochplan%20setzen!%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22Move%20lines%20containing%20a%20completed%20markdown%20task%20(%E2%80%9C-%20%5Bx%5D%E2%80%9D)%20to%20the%20bottom%20of%20the%20current%20draft.%22,%22backingIsSeparator%22:false,%22uuid%22:%22F2DE3B98-5287-489B-A3B8-52A878FA4C5C%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%2297CA4F47-66E4-43D4-BF83-8F2C5EF7FCF1%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22let%20kochplan%20%3D%20Draft.queryByTitle(%5C%22Kochplan:%5C%22)%5B0%5D%5Cnkochplan.content%20%3D%20kochplan.content.replace(%5C/%5E.*@done%5C%5Cn?%5C/gm,%20'');%5Cnkochplan.update();%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22428-checkmark1%22,%22disposition%22:3,%22visibility%22:1760,%22keyCommand%22:%7B%22type%22:%22action%22,%22shiftKey%22:false,%22optionKey%22:false,%22commandKey%22:false,%22input%22:%22%22,%22discoverabilityTitle%22:%22Kochplan%20aufr%C3%A4umen%22,%22controlKey%22:false%7D,%22keyUseIcon%22:true,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:1,%22notificationType%22:1,%22shouldConfirm%22:false,%22name%22:%22Kochplan%20aufr%C3%A4umen%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%22B9F05179-DE48-43B0-AD65-348B5EC51246%22,%22steps%22:%5B%7B%22platforms%22:3,%22uuid%22:%22BFA65010-4778-410A-9139-A1BAECA326B0%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22%5C/%5C/%20f%C3%BCgt%20einen%20Link%20zum%20aktuellen%20Draft%20einem%20bestehenden%20Men%C3%BCplanungsdraft%20in%20der%20Inbox%20hinzu%5Cnconst%20thisdraft%20%3D%20draft.processTemplate(%5C%22%5B%5Bdisplay_title%5D%5D%5C%22);%5Cnconst%20thisdraftlink%20%3D%20%60-%20%5B%5B%60%20+%20thisdraft%20+%20%60%5D%5D%60;%5Cnconst%20planungsdrafts%20%3D%20Draft.query(%5C%22%5C%22,%20%5C%22inbox%5C%22,%20%5B%5C%22men%C3%BCplanung%5C%22%5D)%5Cnconst%20workspace%20%3D%20Workspace.find(%5C%22Men%C3%BCplanung%5C%22);%5Cnconst%20LastDraftModified%20%3D%20Draft.query(%5C%22%5C%22,%20%5C%22all%5C%22,%20%5B%5D,%20%5B%5D,%20%5C%22modified%5C%22,%20true)%5B0%5D;%5Cnconst%20%5BlStart,%20lEnd%5D%20%3D%20editor.getSelectedLineRange();%5Cnconst%20currentLine%20%3D%20editor.getTextInRange(lStart,%20lEnd).trim();%5Cn%5Cnlet%20menuplanung%20%3D%20null;%5Ct%5C/%5C/richtiger%20Men%C3%BCplanungs-Draft%5Cnlet%20task%20%3D%20null;%20%5C/%5C/was%20soll%20zur%20Men%C3%BCplanung%20hinzugef%C3%BCgt%20werden?%5Cnlet%20doneCheck%20%3D%20false;%5Cn%5Cn%5C/%5C/%20geht%20es%20um%20Wein%20oder%20um%20ein%20Rezept?%5Cnif%20(draft.hasTag(%5C%22rezept%5C%22))%20%7B%5Cn%5Cttask%20%3D%20%5C%22rezeptdraft%5C%22;%5Cn%7D%20else%20if%20(draft.hasTag(%5C%22men%C3%BCplanung%5C%22))%20%7B%5Cn%5Cttask%20%3D%20%5C%22zeile%5C%22;%5Cn%7D%20else%20if%20(draft.hasTag(%5C%22wein%5C%22))%20%7B%5Cn%5Cttask%20%3D%20%5C%22wein%5C%22;%5Cn%7D%5Cn%5Cnfunction%20addToMenuplanung()%20%7B%5Cn%5Ctif%20(task%20%3D%3D%20%5C%22rezeptdraft%5C%22)%20%7B%5Cn%5Ct%5Ctif%20(menuplanung.content.includes(%5C%22%23%23%20inv%5C%22))%20%7B%5Cn%5Ct%5Ct%5Ctmenuplanung.content%20%3D%20menuplanung.content.replace(%5C%22%23%23%20inv%5C%22,%20%5C%22%23%23%20inv%5C%5Cn%5C%22%20+%20thisdraftlink)%5Cn%5Ct%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ct%5Ctmenuplanung.content%20%3D%20menuplanung.content%20+%20%5C%22%5C%5Cn%5C%22%20+%20thisdraftlink;%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%20else%20if%20(task%20%3D%3D%20%5C%22zeile%5C%22)%20%7B%5Cn%5Ct%5Ctif%20(menuplanung.content.includes(%5C%22%23%23%20inv%5C%22))%20%7B%5Cn%5Ct%5Ct%5Ctmenuplanung.content%20%3D%20menuplanung.content.replace(%5C%22%23%23%20inv%5C%22,%20%5C%22%23%23%20inv%5C%5Cn%5C%22%20+%20currentLine)%5Cn%5Ct%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ct%5Ctmenuplanung.content%20%3D%20menuplanung.content%20+%20%5C%22%5C%5Cn%5C%22%20+%20currentLine;%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%20else%20if%20(task%20%3D%3D%20%5C%22wein%5C%22)%20%7B%5Cn%5Ct%5Ctif%20(menuplanung.content.includes(%5C%22%23%23%20Wein%5C%22))%20%7B%5Cn%5Ct%5Ct%5Ctmenuplanung.content%20%3D%20menuplanung.content.replace(%5C%22%23%23%20Wein%5C%22,%20%5C%22%23%23%20Wein%5C%5Cn%5C%22%20+%20currentLine)%5Cn%5Ct%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ct%5Ctmenuplanung.content%20%3D%20menuplanung.content%20+%20%5C%22%5C%5Cn%5C%22%20+%20currentLine;%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%20else%20%7B%5Cn%5Ct%5Ctmenuplanung.content%20%3D%20menuplanung.content%20+%20%5C%22%5C%5Cn%5C%22%20+%20currentLine;%5Cn%5Ct%7D%5Cn%5Ct%5Ctmenuplanung.update();%5Cn%5Ct%5CtdoneCheck%20%3D%20true;%5Cn%5Ct%5Ctreturn%20menuplanung;%5Cn%7D%5Cn%5Cn%5C/%5C/%20richtigen%20men%C3%BCplanungs-Draft%20finden%5Cnif%20(LastDraftModified.hasTag(%5C%22men%C3%BCplanung%5C%22)%20%26%26%20!LastDraftModified.isArchived%20%26%26%20!LastDraftModified.isTrashed)%20%7B%5Cn%5Ctmenuplanung%20%3D%20LastDraftModified;%5Cn%5CtaddToMenuplanung();%5Cn%7D%20else%20if%20(planungsdrafts.length%20%3D%3D%200)%20%7B%5Cn%5Ctapp.displayErrorMessage(%5C%22kein%20Men%C3%BCplanungs-Draft%20gefunden%20:(%5C%22)%5Cn%7D%20else%20if%20(planungsdrafts.length%20%3D%3D%201)%20%7B%5Cn%5Ctmenuplanung%20%3D%20planungsdrafts%5B0%5D;%5Cn%5CtaddToMenuplanung();%5Cn%7D%20else%20if%20(planungsdrafts.length%20%3E%200)%20%7B%5Cn%5Ctmenuplanung%20%3D%20app.selectDraft(workspace);%5Cn%5CtaddToMenuplanung();%5Cn%7D%5Cn%5Cnif%20(doneCheck)%20%7B%5Cn%5Ctlet%20menuplanungTitle%20%3D%20menuplanung.processTemplate(%5C%22%5B%5Bdisplay_title%5D%5D%5C%22);%5Cn%5Ctapp.displayInfoMessage(%5C%22%F0%9F%8E%AF%5C%22%20+%20menuplanungTitle)%5Cn%7D%22%7D,%22type%22:%22script%22,%22isEnabled%22:true%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22553-serving-tray%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22type%22:%22action%22,%22input%22:%22%22,%22commandKey%22:false,%22optionKey%22:false,%22controlKey%22:false,%22shiftKey%22:false,%22discoverabilityTitle%22:%22zur%20Men%C3%BCplanung%20hinzuf%C3%BCgen%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22zur%20Men%C3%BCplanung%20hinzuf%C3%BCgen%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%22E9F3249E-9F26-4218-B408-B30CB32BDF35%22,%22steps%22:%5B%5D,%22assignTags%22:%5B%5D,%22icon%22:%22%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22optionKey%22:false,%22input%22:%22%22,%22type%22:%22empty%22,%22commandKey%22:false,%22shiftKey%22:false,%22discoverabilityTitle%22:%22Invalid%22,%22controlKey%22:false%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22separator%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22none%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Journal%20culinaire%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%2244CDB0FD-5EEB-4166-95C9-F83B3C8E40FA%22,%22steps%22:%5B%7B%22isEnabled%22:true,%22type%22:%22script%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22Date.prototype.getWeek%20%3D%20function()%20%7B%5Cn%20%20const%20date%20%3D%20new%20Date(this.getTime());%5Cn%20%20date.setHours(0,%200,%200,%200);%5Cn%20%20if%20(date.getDay()%20%3D%3D%3D%200)%20%7B%5Cn%20%20%20%20date.setDate(date.getDate()%20+%201);%5Cn%20%20%7D%5Cn%20%20date.setDate(date.getDate()%20+%20(1%20-%20date.getDay()%20+%207)%20%25%207);%5Cn%20%20const%20week1%20%3D%20new%20Date(date.getFullYear(),%200,%204);%5Cn%20%20return%201%20+%20Math.round(((date.getTime()%20-%20week1.getTime())%20%5C/%2086400000%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%203%20+%20(week1.getDay()%20+%206)%20%25%207)%20%5C/%207);%5Cn%7D;%5Cn%5Cnvar%20heute%20%3D%20new%20Date();%5Cnvar%20weekNumber%20%3D%20heute.getWeek();%5Cn%5Cnvar%20dd%20%3D%20String(heute.getDate()).padStart(2,%20'0');%5Cnvar%20mm%20%3D%20String(heute.getMonth()%20+%201).padStart(2,%20'0');%20%5C/%5C/January%20is%200!%5Cnvar%20yyyy%20%3D%20heute.getFullYear();%5Cn%5Cn%5Cnconst%20wochentag%20%3D%20new%20Array(%5C%22Mo%5C%22,%20%5C%22Di%5C%22,%20%5C%22Mi%5C%22,%20%5C%22Do%5C%22,%20%5C%22Fr%5C%22,%20%5C%22Sa%5C%22,%20%5C%22So%5C%22)%5Cnconst%20woche%20%3D%20Array.from(Array(7).keys()).map((idx)%20%3D%3E%20%7B%5Cn%20%20%20%20const%20d%20%3D%20new%20Date();%20%5Cn%20%20%20%20d.setDate(d.getDate()%20-%20d.getDay()%20+%20idx%20+%201);%20%5Cn%20%20%20%20return%20String(d.getDate()).padStart(2,%20'0')%20+%20'.'%20+%20String(d.getMonth()%20+%201).padStart(2,%20'0')%20+%20'.';%5Cn%20%20%20%20%7D%5Cn);%5Cn%5Cnfunction%20zuordnung()%20%7B%5Cn%20%20%20%20return%20wochentag.flatMap(function%20(val,%20i)%20%7B%5Cn%20%20%20%20%20%20if%20(woche%5Bi%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20return%20%5Bval%20+%20'%20'%20+%20woche%5Bi%5D%20+%20'%20-%20'%5D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20%5Bval%5D;%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%5Cnlet%20liste%20%3D%20'%5C%5CnKW%20'%20+%20weekNumber%20+%20'%5C%5Cn'%20+%20zuordnung(wochentag,%20woche).join('%5C%5Cn');%5Cn%5Cnlet%20query%20%3D%20%5C%22Journal%20culinaire%20%5C%22%20+%20yyyy;%5Cnlet%20journal%20%3D%20Draft.queryByTitle(query)%5B0%5D;%5Cn%5Cnjournal.insert(liste,%201)%5Cnjournal.update()%22%7D,%22platforms%22:3,%22uuid%22:%22EEAE7769-A4FC-47F4-8097-728980214619%22%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22calendar-add%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22input%22:%22%22,%22controlKey%22:false,%22optionKey%22:false,%22type%22:%22action%22,%22commandKey%22:false,%22discoverabilityTitle%22:%22Neue%20Woche%20ins%20Journal%22,%22shiftKey%22:false%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Neue%20Woche%20ins%20Journal%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%229CF6D4E5-8FCF-495F-A66E-70FE769EAE0D%22,%22steps%22:%5B%7B%22isEnabled%22:true,%22type%22:%22script%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22%5C/%5C/%20kulinarischer%20Tagebucheintrag%5Cnvar%20journalEntry%20%3D%20%5C%22%5C%22;%5Cnlet%20inJournal%20%3D%20false;%5Cnlet%20currentLine%20%3D%20%5C%22%5C%22;%5Cn%5Cn%5C/%5C/%20Aktuelles%20Datum%5Cnconst%20currentDate%20%3D%20new%20Date();%5Cn%5Ct%5Cn%5C/%5C/%20Tag%20und%20Monat%20mit%20f%C3%BChrender%20Null%20generieren%5Cnconst%20day%20%3D%20String(currentDate.getDate()).padStart(2,%20'0');%5Cnconst%20month%20%3D%20String(currentDate.getMonth()%20+%201).padStart(2,%20'0');%5Cnconst%20formattedDate%20%3D%20%60$%7Bday%7D.$%7Bmonth%7D.%60;%5Cn%5Cnconst%20currentYear%20%3D%20%60$%7BcurrentDate.getFullYear()%7D%60;%5Cn%5Cnconst%20journal%20%3D%20Draft.queryByTitle(%5C%22Journal%20culinaire%20%5C%22%20+%20currentYear)%5B0%5D;%5Cn%5Cn%5C/%5C/%20Eintrags-Men%C3%BC%5Cnfunction%20showMenu()%20%7B%5Cn%5Ct%5C/%5C/%20Men%C3%BC%5Cn%5Ctlet%20menu%20%3D%20Prompt.create();%5Cn%5Ctmenu.title%20%3D%20%5C%22kulinarischer%20Tagebucheintrag%5C%22;%5Cn%5Ctmenu.message%20%3D%20%5C%22Was%20gab's%20denn?%5C%22;%5Cn%5Ctmenu.addTextField('entry',%20'Es%20gab:',%20'');%5Cn%5Ctmenu.addButton(%5C%22OK%5C%22,%200,%20true);%5Cn%5Ctmenu.addButton(%5C%22Rezept%20gekocht%5C%22,%201,%20false,%20true);%5Cn%5Ctmenu.addButton(%5C%22es%20gab%20Reste%5C%22,%202,%20false);%5Cn%5Ctmenu.addButton(%5C%22heute%20nicht%20gekocht%5C%22,%203,%20false);%5Cn%5Ctmenu.show();%5Cn%5Cn%5Ct%5C/%5C/%203%20einfache%20F%C3%A4lle:%5Cn%5Ct%5C/%5C/%20OK%5Cn%5Ctif%20(menu.buttonPressed%20%3D%3D%200)%20%7B%5Cn%5Ct%5CtjournalEntry%20%3D%20menu.fieldValues%5B%5C%22entry%5C%22%5D;%5Cn%5Ct%5Cteditor.setSelectedText(journalEntry);%5Cn%5Cn%5Ct%5C/%5C/%20es%20gab%20Reste%5Cn%5Ct%7D%20else%20if%20(menu.buttonPressed%20%3D%3D%202)%20%7B%5Cn%5Ct%5CtjournalEntry%20%3D%20%5C%22(Reste)%5C%22%5Cn%5Ct%5Cteditor.setSelectedText(journalEntry);%5Cn%5Cn%5Ct%5C/%5C/%20heute%20nicht%20gekocht%5Cn%5Ct%7D%20else%20if%20(menu.buttonPressed%20%3D%3D%203)%20%7B%5Cn%5Ct%5CtjournalEntry%20%3D%20%5C%22(nichts)%5C%22%5Cn%5Ct%5Cteditor.setSelectedText(journalEntry);%5Cn%5Cn%5Ct%5C/%5C/%20ein%20komplexerer%20Fall:%5Cn%5Ct%5C/%5C/%20Rezept%20gekocht%5Cn%5Ct%7D%20else%20if%20(menu.buttonPressed%20%3D%3D%201)%20%7B%5Cn%5Cn%5Ct%5Ctlet%20text%20%3D%20editor.getText();%5Cn%5Ct%5Ctlet%20pos%20%3D%20editor.getSelectedRange()%5B0%5D;%5Cn%5Ct%5Ctlet%20before%20%3D%20text.slice(pos-14,%20pos);%5Cn%5Ct%5Ctlet%20regex%20%3D%20%5C/(%5C%5C.%20-%20)%7C%5C%5Cw%5C%5C.%5C/g;%5Cn%5Ct%5Ctlet%20rezept%20%3D%20draft;%5Cn%5Cn%5Ct%5Ctlet%20workspace%20%3D%20Workspace.find(%5C%22Rezepte%5C%22);%5Cn%5Ct%5Ctlet%20d%20%3D%20app.selectDraft(workspace);%5Cn%5Ct%5Ctif(d)%20%7B%5Cn%5Ct%5Ct%5Ctrezept%20%3D%20d;%5Cn%5Ct%5Ct%5Ctd.isFlagged%20%3D%20false;%5Cn%5Ct%5Ct%5Ctd.update();%5Cn%5Ct%5Ct%5Ctif%20(regex.test(before))%20%7B%5Cn%5Ct%5Ct%20%20%20%20%20%20editor.setSelectedText(%60$%7Bd.displayTitle%7D%60);%20%20%20%5Cn%5Ct%5Ct%20%20%20%7D%20else%20%7B%5Cn%5Ct%5Ct%20%20%20%5Cteditor.setSelectedText(';%20'%20+%20%60$%7Bd.displayTitle%7D%60);%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%7D%5Cn%5Cn%5Ct%5Ctlet%20ratePromt%20%3D%20Prompt.create();%5Cn%5Ct%5CtratePromt.title%20%3D%20%5C%22Wie%20hat's%20geschmeckt?%5C%22%5Cn%5Ct%5CtratePromt.message%20%3D%20%5C%22Soll%20das%20Rezept%20aufbewahrt%20oder%20verworfen%20werden?%5C%22%5Cn%5Ct%5CtratePromt.addButton(%5C%22hat%20gut%20geschmeckt!%5C%22,%208)%5Cn%5Ct%5CtratePromt.addButton(%5C%22das%20koche%20ich%20nie%20wieder!%5C%22,%209)%5Cn%5Cn%5Ct%5Ctif%20(rezept.hasTag(%5C%22neuesrezept%5C%22))%20%7B%5Cn%5Ct%5Ct%5Ctif%20(ratePromt.show())%20%7B%5Cn%5Ct%5Ct%5Ct%5Ctif%20(ratePromt.buttonPressed%20%3D%3D%208)%20%7B%5Cn%5Ct%5Ct%5Ct%5Ct%5Ct%5C/%5C/app.queueAction(gutgeschmeckt);%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctrezept.removeTag(%5C%22neuesrezept%5C%22);%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctrezept.update();%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctapp.displaySuccessMessage(rezept.displayTitle%20+%20%5C%22:%20hat%20gut%20geschmeckt!%5C%22)%5Cn%5Ct%5Ct%5Ct%5Ct%7D%20else%20if%20(ratePromt.buttonPressed%20%3D%3D%209)%20%7B%5Cn%5Ct%5Ct%5Ct%5Ct%5Ct%5C/%5C/app.queueAction(niewieder);%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctrezept.removeTag(%5C%22neuesrezept%5C%22);%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctrezept.removeTag(%5C%22rezept%5C%22)%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctrezept.addTag(%5C%22verworfenesrezept%5C%22);%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctrezept.update();%5Cn%5Ct%5Ct%5Ct%5Ct%5Ctapp.displaySuccessMessage(rezept.displayTitle%20+%20%5C%22:%20koche%20ich%20nie%20wieder!%5C%22)%5Cn%5Ct%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%5Ct%7D%5Cn%5Ct%5Ct%7D%5Cn%5Ct%7D%20else%20%7B%20%5C/%5C/%20es%20steht%20schon%20etwas%20an%20dem%20Tag:%20Nur%20Journal%20offnen%5Cn%5Ct%5Ctcontext.cancel();%5Cn%5Ct%7D%5Cn%7D%5Cn%5Cn%5Cn%5C/%5C/%20HIER%20BEGINNT%20DER%20ABLAUF:%5Cn%5Cn%5Cn%5C/%5C/%20zum%20Journal-Draft%5Cnif%20(draft.displayTitle%20%3D%3D%20%5C%22Journal%20culinaire%20%5C%22%20+%20currentYear)%20%7B%5Cn%5Ctlet%20inJournal%20%3D%20true;%5Cn%5Ct%5C/%5C/%20Zeile%20im%20Journal%20abrufen%5Cn%5Ctvar%20%5BlStart,%20lEnd%5D%20%3D%20editor.getSelectedLineRange();%5Cn%5CtcurrentLine%20%3D%20editor.getTextInRange(lStart,%20lEnd);%5Cn%5CtshowMenu();%5Cn%7D%20else%20%7B%5Cn%5Cteditor.load(journal);%5Cn%5Cn%5Ct%5C/%5C/%20zum%20heutigen%20Tag%20im%20Journal%5Cn%5Ctlet%20text%20%3D%20journal.content;%20%5C/%5C/%20Text%20der%20aktuellen%20Draft%5Cn%5Ctconst%20lines%20%3D%20text.split('%5C%5Cn');%20%5C/%5C/%20Zeilen%20im%20Text%20aufteilen%5Cn%5Cn%5Ct%5C/%5C/%20Index%20der%20Zeile%20mit%20dem%20aktuellen%20Datum%20finden%5Cn%5Ctlet%20targetLineIndex%20%3D%20-1;%5Cn%5Ctfor%20(let%20i%20%3D%200;%20i%20%3C%20lines.length;%20i++)%20%7B%5Cn%5Ct%20%20%20%20if%20(lines%5Bi%5D.substring(3).startsWith(formattedDate))%20%7B%5Cn%5Ct%20%20%20%20%20%20%20%20targetLineIndex%20%3D%20i;%5Cn%5Ct%20%20%20%20%5CtcurrentLine%20%3D%20lines%5Bi%5D;%5Cn%5Ct%20%20%20%20%20%20%20%20break;%5Cn%5Ct%20%20%20%20%7D%5Cn%5Ct%7D%5Cn%5Cn%5Ct%5C/%5C/%20Wenn%20die%20Zeile%20mit%20dem%20aktuellen%20Datum%20gefunden%20wurde%5Cn%5Ctif%20(targetLineIndex%20!%3D%3D%20-1)%20%7B%5Cn%5Ct%20%20%20%20%5C/%5C/%20Cursor%20zum%20Ende%20der%20Zeile%20setzen%5Cn%5Ct%20%20%20%20const%20cursorPosition%20%3D%20lines%5BtargetLineIndex%5D.length%20+%201;%5Cn%5Ct%20%20%20%20editor.setSelectedRange(lines.slice(0,%20targetLineIndex).join('%5C%5Cn').length%20+%20cursorPosition,%200);%5Cn%5Ct%20%20%20%20showMenu();%5Cn%5Ct%7D%20else%20%7B%5Cn%5Ct%20%20%20%20%5C/%5C/%20Wenn%20das%20aktuelle%20Datum%20nicht%20gefunden%20wurde%5Cn%5Ct%20%20%20%20app.displayWarningMessage(%5C%22Das%20aktuelle%20Datum%20wurde%20nicht%20gefunden.%5C%22);%5Cn%5Ct%7D%5Cn%7D%22%7D,%22platforms%22:3,%22uuid%22:%229A2FFE17-588C-407C-B965-5AA2E5657384%22%7D,%7B%22isEnabled%22:true,%22type%22:%22configure%22,%22data%22:%7B%22draftList%22:%22noChange%22,%22actionBar%22:%22noChange%22,%22tagEntry%22:%22noChange%22,%22loadWorkspace%22:%22%22,%22linksEnabled%22:%22noChange%22,%22pinningEnabled%22:%22noChange%22,%22actionList%22:%22hide%22,%22loadActionGroup%22:%22%22,%22loadActionBarGroup%22:%22%22%7D,%22platforms%22:1,%22uuid%22:%22AC5432B3-9AE4-4236-BDC1-90566B328882%22%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22edit%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22optionKey%22:false,%22controlKey%22:false,%22shiftKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22input%22:%22%22,%22discoverabilityTitle%22:%22kulinarischer%20Tagebucheintrag%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22kulinarischer%20Tagebucheintrag%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%229B6EC4CB-2E68-4B22-8BE9-3EA8BD5FD235%22,%22steps%22:%5B%7B%22isEnabled%22:true,%22type%22:%22script%22,%22data%22:%7B%22script%22:%22let%20template%20%3D%20%5C%22%23%20%5C%5Cn%E2%84%B9%EF%B8%8F%20%5C%5Cn%F0%9F%91%83%20%5C%5Cn%F0%9F%91%84%20%5C%5Cn%F0%9F%92%AC%20%5C%5Cn%E2%AD%90%20%5C%22%5Cnlet%20wine%20%3D%20%5C%22%5C%22;%5Cn%5Cn%5C/%5C/%20Zeile%5Cnvar%20%5BlStart,%20lEnd%5D%20%3D%20editor.getSelectedLineRange();%5Cnvar%20line%20%3D%20editor.getTextInRange(lStart,%20lEnd).trim();%5Cn%5Cn%5C/%5C/%20Wein%20aus%20Eintrag%20ableiten%5Cnif%20(line.substring(0,%202)%20%3D%3D%20%5C%22-%20%5C%22)%20%7B%5Cn%20%20%20%20wine%20%3D%20line.substring(2)%5Cn%7D%5Cn%5Cn%5C/%5C/%20Quick-VKN%20erstellen%5Cnlet%20quickvkn%20%3D%20new%20Draft();%5Cn%5Cn%5C/%5C/%20Titel%20und%20Schablone%20einsetzen%5Cnif%20(wine)%20%7B%5Cn%20%20%20%20quickvkn.content%20%3D%20%5C%22%23%20%5C%22%20+%20wine%20+%20template;%5Cn%7D%20else%20%7B%5Cn%20%20%20%20quickvkn.content%20%3D%20%20template;%5Cn%7D%5Cn%5Cn%5C/%5C/%20Tag%20setzen%20und%20zur%20VKN%20springen%5Cnquickvkn.addTag(%5C%22quickvkn%5C%22);%5Cnquickvkn.update();%5Cneditor.load(quickvkn);%22,%22allowAsync%22:%22false%22%7D,%22platforms%22:3,%22uuid%22:%221B5A4823-6A3F-4B94-88F2-6645A01E0D1A%22%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22pencil%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22discoverabilityTitle%22:%22Quick%20VKN%22,%22optionKey%22:false,%22shiftKey%22:false,%22commandKey%22:false,%22controlKey%22:false,%22input%22:%22%22,%22type%22:%22action%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Quick%20VKN%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%22EF589409-F635-4571-A360-55895A77CFFB%22,%22steps%22:%5B%7B%22isEnabled%22:true,%22type%22:%22script%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22%5C/%5C/%20Utility%20functions%5Cnfunction%20getYearFromTitle()%20%7B%5Cn%20%20%20%20let%20yearMatch%20%3D%20editor.draft.displayTitle.match(%5C/Journal%5C%5Csculinaire%5C%5Cs(%5C%5Cd%7B4%7D)%5C/);%5Cn%20%20%20%20return%20yearMatch%20?%20yearMatch%5B1%5D%20:%20draft.processTemplate('%5B%5Bdate%7C%25Y%5D%5D');%5Cn%7D%5Cn%5Cnfunction%20formatAndUpdate(draft)%20%7B%5Cn%20%20%20%20draft.update();%5Cn%20%20%20%20draft.content%20%3D%20draft.content.replace(%5C/%5C%5Cn%7B2,%7D%5C/g,%20'%5C%5Cn%5C%5Cn');%20%5C/%5C/%20Doppelte%20Leerzeilen%20in%20einfache%20umwandeln%5Cn%20%20%20%20draft.content%20%3D%20draft.content.replace(%5C/(%5E(?!%23).*%5C%5Cn)%5E(%23)%5C/gm,%20'$1%5C%5Cn$2');%20%5C/%5C/%20Leerzeilen%20vor%20Zeilen,%20die%20mit%20'%23'%20beginnen,%20einf%C3%BCgen%5Cn%20%20%20%20draft.update();%5Cn%7D%5Cn%5Cnfunction%20getDrinkDate(line,%20drinkyear)%20%7B%5Cn%20%20%20%20let%20today%20%3D%20draft.processTemplate('%5B%5Bdate%7C%25d.%25m.%25Y%5D%5D');%5Cn%20%20%20%20let%20extractedDate%20%3D%20line.match(%5C/%5E%5C%5Cw%7B2%7D%5C%5Cs(%5C%5Cd%7B2%7D%5C%5C.%5C%5Cd%7B2%7D%5C%5C.)%5C%5Cs-%5C%5Cs%5C/);%5Cn%20%20%20%20return%20extractedDate%20?%20extractedDate%5B1%5D%20+%20drinkyear%20:%20today;%5Cn%7D%5Cn%5Cnfunction%20showWarningPrompt()%20%7B%5Cn%20%20%20%20let%20warningPrompt%20%3D%20Prompt.create();%5Cn%20%20%20%20warningPrompt.title%20%3D%20%5C%22Willst%20Du%20das%20wirklich?%5C%22;%5Cn%20%20%20%20warningPrompt.message%20%3D%20%5C%22Diese%20Aktion%20sollte%20normalerweise%20im%20kulinarischen%20Tagebuch%20in%20der%20Zeile%20des%20Verkostungstages%20ausgel%C3%B6st%20werden.%5C%22;%5Cn%20%20%20%20warningPrompt.addButton(%5C%22trotzdem%20fortfahren%5C%22);%5Cn%20%20%20%20return%20warningPrompt.show()%20%26%26%20warningPrompt.buttonPressed%20%3D%3D%3D%20%5C%22trotzdem%20fortfahren%5C%22;%5Cn%7D%5Cn%5Cnfunction%20curateProtokoll(protokoll,%20protokolleintrag,%20drinkdate)%20%7B%5Cn%20%20%20%20let%20eintraege%20%3D%20protokoll.content.split(%5C%22%5C%5Cn%5C%22);%5Cn%20%20%20%20let%20letzterEintrag%20%3D%20eintraege%5Beintraege.length%20-%201%5D;%5Cn%20%20%20%20let%20datumLetzterEintrag%20%3D%20letzterEintrag.split(%5C%22%20-%20%5C%22)%5B0%5D;%5Cn%5Cn%20%20%20%20if%20(datumLetzterEintrag%20%3D%3D%20drinkdate)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20nurWein%20%3D%20protokolleintrag.split(%5C/(%5C%5Cd%7B2%7D%5C%5C.%5C%5Cd%7B2%7D%5C%5C.%5C%5Cd%7B4%7D)%20-%20(.*)%5C/)%5B2%5D;%5Cn%20%20%20%20%20%20%20%20protokolleintrag%20%3D%20letzterEintrag%20+%20%5C%22,%20%5C%22%20+%20nurWein;%5Cn%20%20%20%20%20%20%20%20eintraege.pop();%5Cn%20%20%20%20%7D%5Cn%20%20%20%20eintraege.push(protokolleintrag);%5Cn%20%20%20%20protokoll.content%20%3D%20eintraege.join(%5C%22%5C%5Cn%5C%22);%5Cn%20%20%20%20protokoll.update();%5Cn%7D%5Cn%5Cnfunction%20createVKN(vintage,%20wine,%20vkntemplate)%20%7B%5Cn%20%20%20%20let%20vkn%20%3D%20Draft.create();%5Cn%20%20%20%20vkn.content%20%3D%20%60%23%20$%7Bwine%7D%5C%5Cn$%7Bvkntemplate%7D%60;%5Cn%20%20%20%20vkn.isArchived%20%3D%20true;%5Cn%20%20%20%20vkn.addTag(%5C%22vkn%5C%22);%5Cn%20%20%20%20vkn.update();%5Cn%20%20%20%20return%20vkn;%5Cn%7D%5Cn%5Cnfunction%20useQuickVKN(existingQuickVKN,%20drinkdate)%20%7B%5Cn%20%20%20%20let%20wineFromQuickVKN%20%3D%20%7B%5Cn%20%20%20%20%20%20%20%20name:%20existingQuickVKN.displayTitle.replace(%5C/%5C%5Cd%7B4%7D%5C/,%20'').trim(),%5Cn%20%20%20%20%20%20%20%20vintage:%20existingQuickVKN.displayTitle.match(%5C/%5C%5Cd%7B4%7D%5C/)?.%5B0%5D%20%7C%7C%20%5C%22%5C%22,%5Cn%20%20%20%20%20%20%20%20text:%20existingQuickVKN.content.split('%5C%5Cn').slice(1).join('%5C%5Cn')%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20let%20targetWine%20%3D%20%7B%5Cn%20%20%20%20%20%20%20%20name:%20wineFromQuickVKN.name,%5Cn%20%20%20%20%20%20%20%20vintage:%20wineFromQuickVKN.vintage,%5Cn%20%20%20%20%20%20%20%20draft:%20null%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20let%20matchPrompt%20%3D%20Prompt.create();%5Cn%20%20%20%20matchPrompt.title%20%3D%20%5C%22Wein%5C%22;%5Cn%20%20%20%20matchPrompt.message%20%3D%20%60Ist%20der%20Name%20des%20Weins%20so%20korrekt?%5C%5Cn%5C%5CnWein:%20$%7BwineFromQuickVKN.name%7D%5C%5CnJahrgang:%20$%7BwineFromQuickVKN.vintage%7D%60;%5Cn%20%20%20%20matchPrompt.addTextField(%5C%22correctedName%5C%22,%20%5C%22korrekter%20Name%5C%22,%20wineFromQuickVKN.name);%5Cn%20%20%20%20matchPrompt.addTextField(%5C%22correctedYear%5C%22,%20%5C%22korrekter%20Jahrgang%5C%22,%20wineFromQuickVKN.vintage);%5Cn%20%20%20%20matchPrompt.addButton(%5C%22%C3%9Cbernehmen%5C%22);%5Cn%5Cn%20%20%20%20if%20(matchPrompt.show()%20%26%26%20matchPrompt.buttonPressed%20%3D%3D%3D%20%5C%22%C3%9Cbernehmen%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20targetWine.name%20%3D%20matchPrompt.fieldValues%5B%5C%22correctedName%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20targetWine.vintage%20%3D%20matchPrompt.fieldValues%5B%5C%22correctedYear%5C%22%5D;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%5C/%5C/%20Check%20if%20a%20VKN%20already%20exists%20for%20this%20wine%5Cn%20%20%20%20let%20existingVKNs%20%3D%20Draft.query(%5C%22%5C%22,%20%5C%22all%5C%22,%20%5B%5C%22vkn%5C%22%5D,%20%5B%5D,%20%5C%22created%5C%22,%20true,%20false);%5Cn%20%20%20%20let%20foundVKN%20%3D%20existingVKNs.find(vkn%20%3D%3E%20vkn.displayTitle.includes(targetWine.name));%5Cn%5Cn%20%20%20%20if%20(foundVKN)%20%7B%5Cn%20%20%20%20%20%20%20%20%5C/%5C/%20Update%20the%20existing%20VKN%5Cn%20%20%20%20%20%20%20%20updateExistingVKN(foundVKN,%20targetWine.vintage,%20drinkdate,%20wineFromQuickVKN.text);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%5C/%5C/%20Create%20a%20new%20VKN%5Cn%20%20%20%20%20%20%20%20let%20vkntemplate%20%3D%20%60%23%23%20Jahrgang%20$%7BtargetWine.vintage%7D%5C%5Cn%23%23%23%20verkostet%20am%20$%7Bdrinkdate%7D%5C%5Cn$%7BwineFromQuickVKN.text%7D%60;%5Cn%20%20%20%20%20%20%20%20let%20vkn%20%3D%20createVKN(targetWine.vintage,%20targetWine.name,%20vkntemplate);%5Cn%20%20%20%20%20%20%20%20insertLinkAndProtokoll(targetWine.vintage,%20vkn.displayTitle,%20drinkdate);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%5C/%5C/%20Trash%20the%20quickVKN%20after%20use%5Cn%20%20%20%20existingQuickVKN.isTrashed%20%3D%20true;%5Cn%20%20%20%20formatAndUpdate(existingQuickVKN);%5Cn%7D%5Cn%5Cnfunction%20updateExistingVKN(existingVKN,%20vintage,%20drinkdate,%20content)%20%7B%5Cn%20%20%20%20let%20vintageHeader%20%3D%20%60%23%23%20Jahrgang%20$%7Bvintage%7D%60;%5Cn%20%20%20%20let%20dateHeader%20%3D%20%60%23%23%23%20verkostet%20am%20$%7Bdrinkdate%7D%60;%5Cn%20%20%20%20let%20lines%20%3D%20existingVKN.content.split('%5C%5Cn');%5Cn%5Cn%20%20%20%20%5C/%5C/%20Find%20the%20index%20of%20the%20vintage%20header%5Cn%20%20%20%20let%20vintageIndex%20%3D%20lines.findIndex(line%20%3D%3E%20line.trim()%20%3D%3D%3D%20vintageHeader);%5Cn%5Cn%20%20%20%20if%20(vintageIndex%20%3D%3D%3D%20-1)%20%7B%5Cn%20%20%20%20%20%20%20%20%5C/%5C/%20If%20the%20vintage%20doesn't%20exist,%20add%20it%20at%20the%20end%20with%20a%20blank%20line%20before%5Cn%20%20%20%20%20%20%20%20lines.push(vintageHeader,%20dateHeader,%20...content.split('%5C%5Cn'),%20'');%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(vintageIndex%20%3D%3D%3D%200%20%7C%7C%20lines%5BvintageIndex%20-%201%5D.trim()%20!%3D%3D%20'')%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20lines.splice(vintageIndex,%200,%20'');%5Cn%20%20%20%20%20%20%20%20%20%20%20%20vintageIndex++;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%5C/%5C/%20Find%20where%20to%20insert%20the%20new%20tasting%20note%5Cn%20%20%20%20%20%20%20%20let%20insertIndex%20%3D%20vintageIndex%20+%201;%5Cn%20%20%20%20%20%20%20%20while%20(insertIndex%20%3C%20lines.length%20%26%26%20!lines%5BinsertIndex%5D.startsWith('%23%23%20'))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20insertIndex++;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%5C/%5C/%20Insert%20the%20new%20tasting%20note%5Cn%20%20%20%20%20%20%20%20lines.splice(insertIndex,%200,%20dateHeader,%20...content.split('%5C%5Cn'));%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%5C/%5C/%20Join%20the%20lines%20back%20together%5Cn%20%20%20%20existingVKN.content%20%3D%20lines.join('%5C%5Cn');%5Cn%5Cn%20%20%20%20formatAndUpdate(existingVKN);%5Cn%20%20%20%20insertLinkAndProtokoll(vintage,%20existingVKN.displayTitle,%20drinkdate);%5Cn%7D%5Cn%5Cnfunction%20insertLinkAndProtokoll(vintage,%20displayTitle,%20drinkdate)%20%7B%5Cn%20%20%20%20let%20linkText%20%3D%20%60$%7Bvintage%7D%20%5B%5B$%7BdisplayTitle%7D%5D%5D%60;%5Cn%20%20%20%20let%20%5Bst,%20len%5D%20%3D%20editor.getSelectedRange();%5Cn%5Cn%20%20%20%20if%20(line.search(%5C/Wein:%5C/)%20%3D%3D%20-1)%20%7B%5Cn%20%20%20%20%20%20%20%20editor.setSelectedText(%5C%22Wein:%20%5C%22%20+%20linkText);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20line%20%3D%20line.trim();%5Cn%20%20%20%20%20%20%20%20editor.setSelectedText(%5C%22,%20%5C%22%20+%20linkText);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20editor.setSelectedRange(st%20+%20linkText.length,%200);%5Cn%5Cn%20%20%20%20let%20protokoll%20%3D%20Draft.queryByTitle(%5C%22Weinprotokoll%5C%22)%5B0%5D;%5Cn%20%20%20%20let%20protokolleintrag%20%3D%20%60$%7Bdrinkdate%7D%20-%20$%7BlinkText%7D%60;%5Cn%20%20%20%20curateProtokoll(protokoll,%20protokolleintrag,%20drinkdate);%5Cn%7D%5Cn%5Cnfunction%20handleVKNSelection(drinkdate)%20%7B%5Cn%20%20%20%20let%20workspace%20%3D%20Workspace.find(%5C%22Verkostungsnotizen%5C%22);%5Cn%20%20%20%20let%20d%20%3D%20app.selectDraft(workspace);%5Cn%20%20%20%20if%20(d)%20%7B%5Cn%20%20%20%20%20%20%20%20if%20(d.displayTitle%20%3D%3D%3D%20'+++%20Neuen%20Wein%20hinzuf%C3%BCgen%20+++')%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20addVKN%20%3D%20Prompt.create();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addVKN.title%20%3D%20%5C%22Wein%20verkostet%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addVKN.message%20%3D%20%5C%22Erzeugt%20eine%20neue%20Verkostungsnotiz%20und%20verlinkt%20sie%20im%20Tagebuch.%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addVKN.addTextField(%5C%22vintage%5C%22,%20%5C%22Jahrgang%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addVKN.addTextField(%5C%22wine%5C%22,%20%5C%22Weingut,%20Wein%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addVKN.addButton(%5C%22VKN%20erstellen%5C%22);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20(addVKN.show()%20%26%26%20addVKN.buttonPressed%20%3D%3D%3D%20%5C%22VKN%20erstellen%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20vintage%20%3D%20addVKN.fieldValues%5B%5C%22vintage%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20wine%20%3D%20addVKN.fieldValues%5B%5C%22wine%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20vkntemplate%20%3D%20%60%23%23%20Jahrgang%20$%7Bvintage%7D%5C%5Cn%23%23%23%20verkostet%20am%20$%7Bdrinkdate%7D%5C%5Cn%E2%84%B9%EF%B8%8F%20%5C%5Cn%F0%9F%91%83%20%5C%5Cn%F0%9F%91%84%20%5C%5Cn%F0%9F%92%AC%20%5C%5Cn%E2%AD%90%20%60;%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20vkn%20%3D%20createVKN(vintage,%20wine,%20vkntemplate);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20insertLinkAndProtokoll(vintage,%20vkn.displayTitle,%20drinkdate);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20if%20(d.displayTitle%20%3D%3D%3D%20'+++%20Schnell-VKN%20%C3%BCbernehmen%20+++')%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20quickVKNs%20%3D%20Draft.query(%5C%22%5C%22,%20%5C%22inbox%5C%22,%20%5B%5C%22quickvkn%5C%22%5D,%20%5B%5D,%20%5C%22created%5C%22,%20true,%20false);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20(quickVKNs.length%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20quickVKNPrompt%20%3D%20Prompt.create();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20quickVKNPrompt.title%20%3D%20%5C%22Schnell-VKN%20ausw%C3%A4hlen%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20quickVKNPrompt.message%20%3D%20%5C%22W%C3%A4hle%20eine%20Schnell-VKN%20aus:%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20quickVKNs.forEach(quickVKN%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20quickVKNPrompt.addButton(quickVKN.displayTitle);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(quickVKNPrompt.show()%20%26%26%20quickVKNPrompt.buttonPressed)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20selectedQuickVKN%20%3D%20quickVKNs.find(quickVKN%20%3D%3E%20quickVKN.displayTitle%20%3D%3D%3D%20quickVKNPrompt.buttonPressed);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20useQuickVKN(selectedQuickVKN,%20drinkdate);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20app.displayWarningMessage(%5C%22Keine%20Schnell-VKNs%20gefunden%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5C/%5C/%20Handle%20existing%20VKN%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20vinTasted%20%3D%20d.content.match(%5C/%5E%23%23%20Jahrgang%20.*$%5C/gm);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if%20(vinTasted%20!%3D%3D%20null)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20vinTastedTrmd%20%3D%20vinTasted.map(x%20%3D%3E%20x.replace(%5C/%23%23%20Jahrgang%20%5C/g,%20''));%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20vintagePrompt%20%3D%20Prompt.create();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vintagePrompt.title%20%3D%20%5C%22Verkosteter%20Jahrgang%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vintagePrompt.message%20%3D%20%5C%22Welcher%20Jahrgang%20wurde%20verkostet?%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vinTastedTrmd.forEach(x%20%3D%3E%20vintagePrompt.addButton(x));%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vintagePrompt.addButton(%5C%22Neuer%20Jahrgang%5C%22);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(vintagePrompt.show()%20%26%26%20vintagePrompt.buttonPressed%20!%3D%3D%20%5C%22%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20enteredVintage%20%3D%20vintagePrompt.buttonPressed;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20vintageTemplate%20%3D%20%60%23%23%23%20verkostet%20am%20$%7Bdrinkdate%7D%5C%5Cn%E2%84%B9%EF%B8%8F%20%5C%5Cn%F0%9F%91%83%20%5C%5Cn%F0%9F%91%84%20%5C%5Cn%F0%9F%92%AC%20%5C%5Cn%E2%AD%90%20%60;%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(enteredVintage%20%3D%3D%3D%20%5C%22Neuer%20Jahrgang%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20newVintagePrompt%20%3D%20Prompt.create();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newVintagePrompt.title%20%3D%20%5C%22Neuer%20Jahrgang%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newVintagePrompt.addTextField(%5C%22neuerJahrgang%5C%22,%20%5C%22Neuer%20Jahrgang%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newVintagePrompt.addButton(%5C%22OK%5C%22);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(newVintagePrompt.show()%20%26%26%20newVintagePrompt.buttonPressed%20%3D%3D%3D%20%5C%22OK%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20enteredVintage%20%3D%20newVintagePrompt.fieldValues%5B%5C%22neuerJahrgang%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(enteredVintage%20!%3D%3D%20%5C%22%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(d.content.includes(%60%23%23%20Jahrgang%20$%7BenteredVintage%7D%60))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20d.content%20%3D%20d.content.replace(%60%23%23%20Jahrgang%20$%7BenteredVintage%7D%60,%20%60%23%23%20Jahrgang%20$%7BenteredVintage%7D%5C%5Cn$%7BvintageTemplate%7D%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20enteredVintageTemplate%20%3D%20%60%5C%5Cn%23%23%20Jahrgang%20$%7BenteredVintage%7D%5C%5Cn$%7BvintageTemplate%7D%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20d.content%20+%3D%20%60$%7BenteredVintageTemplate%7D%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20formatAndUpdate(d);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(line.search(%5C/Wein:%5C/)%20!%3D%3D%20-1)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%20%3D%20line.trim();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20editor.setSelectedText(',%20'%20+%20enteredVintage%20+%20%60%20%5B%5B$%7Bd.displayTitle%7D%5D%5D%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20editor.setSelectedText('Wein:%20'%20+%20enteredVintage%20+%20%60%20%5B%5B$%7Bd.displayTitle%7D%5D%5D%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20protokoll%20%3D%20Draft.queryByTitle(%5C%22Weinprotokoll%5C%22)%5B0%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20protokolleintrag%20%3D%20%60$%7Bdrinkdate%7D%20-%20$%7BenteredVintage%7D%20%5B%5B$%7Bd.displayTitle%7D%5D%5D%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20curateProtokoll(protokoll,%20protokolleintrag,%20drinkdate);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20app.displayWarningMessage(%5C%22Aktion%20abgebrochen%5C%22);%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cn%5C/%5C/%20Main%20script%5Cnvar%20%5BlStart,%20lEnd%5D%20%3D%20editor.getSelectedLineRange();%5Cnvar%20line%20%3D%20editor.getTextInRange(lStart,%20lEnd);%5Cnlet%20drinkyear%20%3D%20getYearFromTitle();%5Cnlet%20drinkdate%20%3D%20getDrinkDate(line,%20drinkyear);%5Cn%5Cnif%20(!editor.draft.displayTitle.startsWith('Journal%20culinaire')%20%26%26%20!showWarningPrompt())%20%7B%5Cn%20%20%20%20context.cancel();%5Cn%7D%20else%20%7B%5Cn%20%20%20%20handleVKNSelection(drinkdate);%5Cn%7D%5Cn%22%7D,%22platforms%22:3,%22uuid%22:%22FAF1BCA2-6BE0-447C-81FC-870EC86F5618%22%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22wine-bottle%22,%22disposition%22:3,%22visibility%22:2016,%22keyCommand%22:%7B%22discoverabilityTitle%22:%22Weinflasche%20entkorkt%22,%22optionKey%22:false,%22shiftKey%22:false,%22commandKey%22:false,%22controlKey%22:false,%22input%22:%22%22,%22type%22:%22action%22%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Weinflasche%20entkorkt%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%229D8076E0-250A-49C3-8AAB-526830C251E7%22,%22steps%22:%5B%7B%22isEnabled%22:true,%22type%22:%22script%22,%22data%22:%7B%22script%22:%22%5C/%5C/%20Zeile%20im%20Journal%5Cnvar%20%5BlStart,%20lEnd%5D%20%3D%20editor.getSelectedLineRange();%5Cnvar%20line%20%3D%20editor.getTextInRange(lStart,%20lEnd).trim();%5Cnif%20(editor.draft.displayTitle.match(%5C/Journal%5C%5Csculinaire%5C%5Cs(%5C%5Cd%7B4%7D)%5C/))%20%7B%5Cn%20%20%20%20year%20%3D%20editor.draft.displayTitle.match(%5C/Journal%5C%5Csculinaire%5C%5Cs(%5C%5Cd%7B4%7D)%5C/)%5B1%5D;%5Cn%20%20%20%20if%20(line.match(%5C/%5C%5Cw%7B2%7D%5C%5Cs%5C%5Cd%7B2%7D%5C%5C.%5C%5Cd%7B2%7D%5C%5C.%5C%5Cs-%5C%5Cs%5C/))%20%7B%5Cn%20%20%20%20%20%20%20%20line%20%3D%20line.replace(%5C/%5E%5C%5Cw%7B2%7D%5C%5Cs(%5C%5Cd%7B2%7D%5C%5C.%5C%5Cd%7B2%7D%5C%5C.)%5C%5Cs-%5C%5Cs%5C/,%20'$1'%20+%20year%20+%20'%20-%20');%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cn%5C/%5C/%20GastEintr%C3%A4ge%5Cnvar%20guestDraft%20%3D%20%5B%5D;%5Cn%5Cn%5C/%5C/Eintrag%20im%20Journal%5Cnlet%20isFirstEntry%20%3D%20false;%5Cnif%20(line.search(%5C/%5C%5C(zu%20Besuch:%5C/)%20!%3D%3D%20-1)%20%7B%5Cn%20%20%20%20isFirstEntry%20%3D%20true;%5Cn%7D%5Cnfunction%20guestEntry()%20%7B%5Cn%20%20%20%20if%20(isFirstEntry)%20%7B%5Cn%20%20%20%20%20%20%20%20editor.setSelectedText(',%20'%20+%20guestsList%20+%20')');%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20editor.setSelectedText('%20(zu%20Besuch:%20'%20+%20guestsList%20+%20')');%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if%20(guestsList.indexOf(',')%20!%3D%3D%20-1)%20%7B%5Cn%20%20%20%20%20%20%20%20line%20+%3D%20'%20(%F0%9F%91%AB%20'%20+%20guestsList%20+%20')';%5Cn%20%20%20%20%7D%5Cn%7D%5Cn%5Cn%5C/%5C/%20updateGuests%5Cnfunction%20updateGuests()%20%7B%5Cn%20%20%20%20%5C/%5C/Eintrag%20auf%20Gast-Draft%5Cn%20%20%20%20guests.forEach(function(g)%20%7B%5Cn%20%20%20%20%20%20%20%20var%20q%20%3D%20'title:'%20+%20g%5Cn%20%20%20%20%20%20%20%20var%20draft%20%3D%20Draft.query(q,%20%5C%22all%5C%22,%20%5B%5C%22besuch%5C%22%5D);%5Cn%20%20%20%20%20%20%20%20guestDraft.push(draft);%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20guestDraft.forEach(function(d)%20%7B%5Cn%20%20%20%20%20%20%20%20d%5B0%5D.append('-%20'%20+%20line)%5Cn%20%20%20%20%20%20%20%20d%5B0%5D.update();%5Cn%20%20%20%20%7D);%5Cn%7D%5Cn%5Cn%5C/%5C/%20addGuests%5Cnfunction%20addGuests()%20%7B%5Cn%20%20%20%20%5C/%5C/%20Promt%20%5Cn%20%20%20%20let%20n%20%3D%20Prompt.create();%5Cn%20%20%20%20n.title%20%3D%20'Neuen%20Gast%20einspeisen';%5Cn%20%20%20%20n.message%20%3D%20'Wer%20war%20denn%20da?%5C%5CnMehrere%20G%C3%A4ste%20bitte%20per%20Komma%20trennen.'%5Cn%20%20%20%20n.addTextField('name',%20'Name',%20'');%5Cn%20%20%20%20n.addButton('OK',%201,%20true);%5Cn%20%20%20%20n.show()%5Cn%20%20%20%20if%20(n.buttonPressed%20%3D%3D%201)%20%7B%20%5C/%5C/%20OK%5Cn%20%20%20%20%20%20%20%20var%20newGuest%20%3D%20n.fieldValues%5B%5C%22name%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20if%20(guests.length%20!%3D%3D%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20guestsList%20+%3D%20',%20'%20+%20newGuest;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20guestsList%20+%3D%20newGuest;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20guestEntry()%5Cn%20%20%20%20%5C/%5C/neuen%20Gast-Draft%5Cn%20%20%20%20newGuest%20%3D%20newGuest.split(%5C%22,%5C%22)%5Cn%20%20%20%20newGuest.forEach(function(n)%20%7B%5Cn%20%20%20%20%20%20%20%20var%20newGuestDraft%20%3D%20Draft.create();%5Cn%20%20%20%20%20%20%20%20newGuestDraft.addTag('besuch');%5Cn%20%20%20%20%20%20%20%20newGuestDraft.isArchived%20%3D%20true;%5Cn%20%20%20%20%20%20%20%20newGuestDraft.content%20%3D%20'%23%20'%20+%20n%20+%20'%5C%5Cn%5C%5Cn-%20'%20+%20line;%5Cn%20%20%20%20%20%20%20%20newGuestDraft.update();%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20%7D;%5Cn%7D%5Cn%5Cn%5Cn%5C/%5C/%20Prompt%5Cnlet%20tag%20%3D%20'besuch'%5Cnlet%20entries%20%3D%20Draft.query(%5C%22%5C%22,%20%5C%22all%5C%22,%20%5Btag%5D)%5Cnlet%20allguests%20%3D%20%5B%5D;%5Cnfor%20(let%20e%20of%20entries)%20%7B%5Cn%5Ctallguests.push(e.processTemplate(%5C%22%5B%5Bdisplay_title%5D%5D%5C%22));%5Cn%7D%5Cnallguests%20%3D%20allguests.sort();%5Cnlet%20s%20%3D%20Prompt.create();%5Cns.title%20%3D%20%5C%22Besuch%20war%20da%5C%22;%5Cns.message%20%3D%20%5C%22Wer%20war%20zu%20Besuch?%5C%22;%5Cns.addSelect('allguests',%20'',%20allguests,%20%5B%5D,%20true);%5Cns.addButton('OK',%201,%20true);%5Cns.addButton(%5C%22Neuer%20Gast%5C%22,%202,%20true);%5Cns.show();%5Cn%5Cn%5C/%5C/%20Wer%20was%20da?%5Cnif%20(s.show)%20%7B%5Cn%20%20%20%20var%20guests%20%3D%20s.fieldValues%5B'allguests'%5D;%5Cn%20%20%20%20var%20guestsList%20%3D%20guests.join(',%20');%5Cn%7D%5Cn%5Cn%5C/%5C/Buttons%20gedr%C3%BCckt%5Cnif%20(s.buttonPressed%20%3D%3D%201)%20%7B%20%5C/%5C/OK%5Cn%20%20%20%20guestEntry();%5Cn%20%20%20%20updateGuests()%5Cn%7D%20else%20if%20(s.buttonPressed%20%3D%3D%202)%20%7B%20%5C/%5C/neuer%20Gast%5Cn%20%20%20%20addGuests()%5Cn%20%20%20%20if%20(guests.length%20!%3D%3D%200)%20%7B%5Cn%20%20%20%20%20%20%20%20updateGuests();%5Cn%20%20%20%20%7D%5Cn%7D%20else%20%7B%20%5C/%5C/cancel%5Cn%20%20%20%20context.cancel()%5Cn%7D%20%22,%22allowAsync%22:%22false%22%7D,%22platforms%22:3,%22uuid%22:%227FDE7E83-1C5B-4DB1-83A3-938575A98C97%22%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22user-add%22,%22visibility%22:2016,%22disposition%22:3,%22keyCommand%22:%7B%22type%22:%22action%22,%22controlKey%22:false,%22discoverabilityTitle%22:%22Besuch%20war%20da%22,%22input%22:%22%22,%22optionKey%22:false,%22shiftKey%22:false,%22commandKey%22:false%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Besuch%20war%20da%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%223EF1DC4C-B6B5-4386-A410-491E3D7A93B9%22,%22steps%22:%5B%5D,%22assignTags%22:%5B%5D,%22icon%22:%22%22,%22visibility%22:2016,%22disposition%22:3,%22keyCommand%22:%7B%22controlKey%22:false,%22type%22:%22empty%22,%22discoverabilityTitle%22:%22Invalid%22,%22commandKey%22:false,%22shiftKey%22:false,%22input%22:%22%22,%22optionKey%22:false%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22separator%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22none%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Textformatierung%22,%22shortName%22:%22%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%22F6A13764-7A2E-4D72-AF49-4BED4897E0B0%22,%22steps%22:%5B%5D,%22assignTags%22:%5B%5D,%22icon%22:%22%22,%22visibility%22:2016,%22disposition%22:3,%22keyCommand%22:%7B%22discoverabilityTitle%22:%22Invalid%22,%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22empty%22,%22shiftKey%22:false%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22separator%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22none%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Teilen%22,%22shortName%22:%22Teilen%22%7D,%7B%22backingPlatforms%22:3,%22groupDisposition%22:0,%22actionDescription%22:%22%22,%22backingIsSeparator%22:false,%22uuid%22:%227B6C4B9D-94FA-4940-9684-021F784A2785%22,%22steps%22:%5B%7B%22isEnabled%22:true,%22type%22:%22script%22,%22data%22:%7B%22allowAsync%22:%22false%22,%22script%22:%22%5C/%5C/%20Kalenderwochen%20sortieren%20in%20Drafts%5Cnlet%20text%20%3D%20draft.content;%5Cn%5Cnfunction%20sortKalenderwochen(input)%20%7B%5Cn%20%20%20%20const%20regex%20%3D%20%5C/(KW%20%5C%5Cd+%5B%5C%5Cs%5C%5CS%5D*?(?%3D(KW%20%5C%5Cd+%7C$)))%5C/g;%5Cn%20%20%20%20const%20wochen%20%3D%20%5B...input.matchAll(regex)%5D.map(match%20%3D%3E%20match%5B0%5D);%5Cn%5Cn%20%20%20%20const%20sortedWochen%20%3D%20wochen.sort((a,%20b)%20%3D%3E%20%7B%5Cn%20%20%20%20%20%20%20%20const%20numA%20%3D%20parseInt(a.match(%5C/KW%20(%5C%5Cd+)%5C/)%5B1%5D,%2010);%5Cn%20%20%20%20%20%20%20%20const%20numB%20%3D%20parseInt(b.match(%5C/KW%20(%5C%5Cd+)%5C/)%5B1%5D,%2010);%5Cn%20%20%20%20%20%20%20%20return%20numA%20-%20numB;%5Cn%20%20%20%20%7D);%5Cn%5Cn%20%20%20%20return%20sortedWochen.join(%5C%22%5C%5Cn%5C%5Cn%5C%22);%5Cn%7D%5Cn%5Cndraft.content%20%3D%20sortKalenderwochen(text);%5Cndraft.update();%20%5C/%5C/%20Speichert%20die%20%C3%84nderungen%20in%20der%20Notiz%22%7D,%22platforms%22:3,%22uuid%22:%22A59F3ED6-DE61-4A28-9911-B21B831BF4B7%22%7D%5D,%22assignTags%22:%5B%5D,%22icon%22:%22action_event%22,%22visibility%22:2016,%22disposition%22:3,%22keyCommand%22:%7B%22discoverabilityTitle%22:%22Kalenderwochen%20sortieren%22,%22optionKey%22:false,%22input%22:%22%22,%22controlKey%22:false,%22commandKey%22:false,%22type%22:%22action%22,%22shiftKey%22:false%7D,%22keyUseIcon%22:false,%22backingActionType%22:%22action%22,%22backingAssignFlag%22:0,%22groupUUID%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22tintColor%22:%22orange%22,%22logLevel%22:2,%22notificationType%22:2,%22shouldConfirm%22:false,%22name%22:%22Kalenderwochen%20sortieren%22,%22shortName%22:%22%22%7D%5D,%22visibility%22:2016,%22disposition%22:0,%22name%22:%22kulinarische%20Informatik%22,%22tintColor%22:%22orange%22,%22uuid%22:%22FCAB03B8-ACCA-4EEF-AC6E-3AACE4AAF657%22,%22changeTag%22:%222wid%22,%22hidden%22:false,%22modifiedAt%22:772994006.368381,%22icon%22:%22416-chefs-hat%22%7D